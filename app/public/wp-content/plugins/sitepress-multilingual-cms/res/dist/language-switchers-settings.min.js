"use strict";var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},WPML_core=WPML_core||{};WPML_core.languageSwitcher=function($,t){var e,l,s,n="wpml-ls-inline-styles-additional-css",i="wpml-ls-inline-styles-dialog",o,a,r=function t(){e=$("#wpml-ls-settings-form"),l=$("#wpml-ls-dialog"),s=e.add(l),c(),w(),k(),m(),p(),g(),$(document).trigger("wpml_ls_admin_loaded")},p=function t(){d(),f(),u(),C(),x(),T(),L(),Y(),Z(),X(),et(),W(),S(),M(),P()},c=function t(){if($("#"+n).length<1){var e=$("<style>");e.attr("id",n),e.appendTo($("head"))}},d=function e(){s.on("change",".js-wpml-ls-trigger-save",function(){lt($(this))}),s.on("keyup",".js-wpml-ls-trigger-need-save",function(){var e=$(this),l=e.closest(".js-wpml-ls-option").find(".js-wpml-ls-messages");it(l,t.strings.leave_text_box_to_save,0,"notice")})},f=function t(){s.on("click",".js-wpml-ls-toggle-slot",function(){var t=$(this),e=$(t.data("target"));e.slideToggle({complete:function l(){e.is(":visible")?(t.addClass("open"),e.find(".js-wpml-ls-row-edit").trigger("click")):t.removeClass("open"),b()}})}).on("click",".js-wpml-ls-toggle-once",function(){var t=$(this).nextAll(".js-wpml-ls-toggle-target");return $(this).find("label").unwrap().find(".js-arrow-toggle").remove(),t.slideToggle(),!1})},u=function t(){s.on("click.tooltip",".js-wpml-ls-tooltip-open",function(t){t.preventDefault(),Q($(this))})},m=function t(){$("#wpml-ls-languages-order").sortable({stop:function t(){lt($(this))}})},w=function t(){l.dialog({dialogClass:"dialog-fixed otgs-ui-dialog wpml-ls-dialog",width:"90%",modal:!0,autoOpen:!1,draggable:!0,resizable:!1}).on("dialogopen",function(){$("body").css("overflow","hidden"),$(".js-wpml-ls-active-tooltip").pointer("close"),b(),y()}).on("dialogclose",function(){$("body").css("overflow",""),$(".js-wpml-ls-active-tooltip").pointer("close"),ot()}),$(window).resize(j)},g=function t(){var e=v();if(e){var l=$("#wpml-language-switcher-"+e.type),s=h(e);$("html, body").animate({scrollTop:l.offset().top},1,function(){var t;if(s)t=s.find(".js-wpml-ls-subform");else{var l=$("#wpml-ls-new-"+e.type+"-template");t=N(l),o=e.slug}z(t)})}},v=function t(){var e=window.location.hash.substring(1).split("/"),l=null,s=e[0]||"",n=e[1]||"";return 0<=$.inArray(s,["menus","sidebars","statics"])&&(l={type:s,slug:n},parent.location.hash=""),l},h=function t(e){var l="[data-item-type="+e.type+"]",s=e.slug?"[data-item-slug="+e.slug+"]":"",n=$("tr"+l+s);return 1===n.length?n:null},j=_.debounce(function(){b(),y()},200),b=function t(){var e=$(window).height()-180;l.dialog("option","maxHeight",e),l.dialog("option","position",{my:"center",at:"center",of:window})},y=function t(){var e=l.find(".js-wpml-ls-preview-wrapper"),s=l.width()>900,n=e.height()+200<l.height();n=n||s&&e.height()<l.height(),n?l.on("scroll.preview",function(){l.find(".js-wpml-ls-preview-wrapper").css({position:"relative",top:l.scrollTop()})}):l.off("scroll.preview").find(".js-wpml-ls-preview-wrapper").css({position:"relative",top:0})},k=function t(l){l=l||e,l.find(".js-wpml-ls-colorpicker").wpColorPicker({change:function t(e){var l=$(e.target).parents(".js-wpml-ls-subform");tt(l)},clear:function t(e){var l=$(e.target).parents(".js-wpml-ls-subform");tt(l)}})},C=function t(){$(".js-wpml-ls-dialog-close").on("click",function(t){t.preventDefault(),O(),l.dialog("close")}),$(".js-wpml-ls-dialog-save").on("click",function(t){t.preventDefault(),$(this).prop("disabled",!0);var e=l.find(".js-wpml-ls-subform");I(e)}),$(".js-wpml-ls-open-dialog").on("click",function(t){t.preventDefault();var e,l=$($(t.target).data("target"));e=l.hasClass("js-wpml-ls-template")?N(l):l.find(".js-wpml-ls-subform"),z(e)})},x=function e(){$(".js-wpml-ls-slot-list").on("click",".js-wpml-ls-row-edit",function(t){t.preventDefault();var e=$($(t.target).parents("tr.js-wpml-ls-row")),l=e.find(".js-wpml-ls-subform");z(l)}).on("click",".js-wpml-ls-row-remove",function(e){if(e.preventDefault(),confirm(t.strings.confirmation_item_remove)){var l=$(this).parents("tr.js-wpml-ls-row"),s=l.data("item-type");l.find(".js-wpml-ls-subform input, .js-wpml-ls-subform select").remove(),lt(l,function(){l.fadeOut(800,function(){l.remove(),q(s)})})}})},T=function t(){s.on("change",".js-wpml-ls-available-slots",function(){var t=$(this).val(),e=$(this).closest(".js-wpml-ls-subform"),l=e.data("item-type");$(this).removeClass("wpml-ls-required"),U(t,l)&&K(e,t)})},A=function t(e){e.find(".js-wpml-ls-colorpicker").each(function(){var t=$(this).clone();$(this).parents(".js-wpml-ls-colorpicker-wrapper").empty().html(t)}),k(e)},D=function t(e){if(o){var l='.js-wpml-ls-available-slots option[value="'+o+'"]';e.find(l).attr("selected","selected"),o=null}},L=function e(){s.on("change",".js-wpml-ls-colorpicker-preset",function(){var e=$(this).val(),l=$(this).parents(".js-wpml-ls-subform");if(e){var s=$(this).parents(".js-wpml-ls-panel-colors"),n=t.color_schemes[e].values;$.each(n,function(t,e){var l=s.find(".js-wpml-ls-color-"+t);l.attr("value",e),l.parents(".wp-picker-container").find(".wp-color-result").css("background-color",e)}),tt(l)}})},W=function t(){s.on("change","select",function(){var t=$(this).val();$("option",this).removeAttr("selected"),$('option[value="'+t+'"]',this).attr("selected","selected")})},S=function t(){var e=$("#wpml-ls-refresh-on-browser-back-button");"yes"===e.val()?location.reload(!0):e.val("yes")},M=function t(){e.submit(function(t){t.preventDefault(),e.find('input[name="submit_setup_wizard"]').val(1),lt(e,function(){location.href=location.href.replace(/#.*/,"")})})},P=function t(){$(".js-wpml-ls-preview").on("click",function(t){t.preventDefault()})},Q=function t(e){var l=e.data("content"),s=e.data("link-text"),n=e.data("link-url"),i=e.data("link-target");if(s.length>0){0===n.length&&(n="#");l+='<br><br><a href="'+n+'" '+('target="'+i+'"')+">",l+=s,l+="</a>"}$(".js-wpml-ls-active-tooltip").pointer("close"),e.length&&l&&(e.addClass("js-wpml-ls-active-tooltip"),e.pointer({pointerClass:"js-wpml-ls-tooltip wpml-ls-tooltip",content:l,position:{edge:"bottom",align:"left"},show:function t(e,l){l.pointer.css("marginLeft","-54px")},close:function t(e,l){l.pointer.css("marginLeft","0")},buttons:function t(e,l){return $('<a class="close" href="#">&nbsp;</a>').bind("click.pointer",function(t){t.preventDefault(),l.element.pointer("close")})}}).pointer("open"))},z=function t(e){var s=e.clone(!0);l.find(".js-wpml-ls-dialog-inner").empty().append(s),""===s.find(".js-wpml-ls-preview").html()&&tt(s),H(e),V(s),A(s),D(s),l.dialog("option","title",s.data("title")).dialog("open")},H=function t(e){var l=e.data("item-type"),s=e.data("item-slug");s="%id%"===s?"__id__":s;var n=$("#wpml-ls-inline-styles-"+l+"-"+s);a=n.detach(),ot(a.clone())},O=function t(){a instanceof jQuery&&a.length>0&&$("#"+n).before(a)},I=function t(e){var l=e.clone(!0),s=e.data("item-type");if(l.find(".js-wpml-ls-preview-wrapper").css("top",0),0<=$.inArray(s,["menus","sidebars"])){var n=e.find(".js-wpml-ls-available-slots").val();U(n,s)?(void 0===l.data("origin-id")?F(l):E(l),q(s)):G(e)}else"statics"===l.data("item-type")&&B(l)},q=function e(l){var s=$("#wpml-language-switcher-"+l),n=s.find(".js-wpml-ls-row").length,i=$.map(t[l],function(t,e){return e}).length;0===n?s.find(".js-wpml-ls-slot-list").fadeOut():s.find(".js-wpml-ls-slot-list").fadeIn(),n===i?s.find("button.js-wpml-ls-open-dialog").attr("disabled","disabled").siblings(".js-wpml-ls-tooltip-wrapper").removeClass("hidden"):s.find("button.js-wpml-ls-open-dialog").removeAttr("disabled").siblings(".js-wpml-ls-tooltip-wrapper").addClass("hidden")},B=function t(e){var s=$("#"+e.data("origin-id")),n=e.data("item-slug");s.find(".js-wpml-ls-subform").replaceWith(e),at("statics",n),lt(s,function(){l.find(".js-wpml-ls-dialog-inner").empty(),l.dialog("close")})},E=function t(e){var s=$("#"+e.data("origin-id")),n=e.data("item-type"),i=e.find(".js-wpml-ls-available-slots").val();s.find(".js-wpml-ls-subform").replaceWith(e),s.attr("id")!=="wpml-ls-"+n+"-row-"+i&&J(s,n,i),at(n,i),lt(s,function(){l.find(".js-wpml-ls-dialog-inner").empty(),l.dialog("close")})},F=function t(s){var n=s.data("item-type"),i=s.find(".js-wpml-ls-available-"+n).val();K(s,i);var o=$.trim($("#wpml-ls-new-"+n+"-row-template").html()),a=$($.parseHTML(o));a.find(".js-wpml-ls-subform").replaceWith(s),J(a,n,i),a.hide().appendTo(e.find("#wpml-ls-slot-list-"+n+" > tbody")).show(800),at(n,i),lt(a,function(){l.find(".js-wpml-ls-dialog-inner").empty(),l.dialog("close")})},G=function t(e){e.find(".js-wpml-ls-available-slots").addClass("wpml-ls-required"),l.animate({scrollTop:0},300),$(".js-wpml-ls-dialog-save").prop("disabled",!1)},J=function e(l,s,n){var i="wpml-ls-"+s+"-row-"+n,o=t[s][n].name;l.attr("id",i),l.data("item-type",s),l.find(".js-wpml-ls-subform").addBack().data("item-slug",n),l.find(".js-wpml-ls-subform").data("origin-id",i),l.find(".js-wpml-ls-row-title").html(o)},K=function t(e,l){var s="",n=e.data("item-type"),i=e.data("item-slug");e.find("input, select").each(function(t,e){s=$(e).attr("name"),"string"==typeof s&&$(e).attr("name",s.replace(n+"["+i+"]",n+"["+l+"]")),"string"==typeof(s=$(e).attr("id"))&&$(e).attr("id",s.replace(i,l))}),e.find("label").each(function(t,e){"string"==typeof(s=$(e).attr("for"))&&$(e).attr("for",s.replace(i,l))})},N=function t(e){var l=$.trim(e.html()),s=$($.parseHTML(l));return V(s),s},R=function t(e){var l=[];return $("#wpml-ls-slot-list-"+e+" .js-wpml-ls-row").each(function(){l.push($(this).data("item-slug"))}),l},U=function e(l,s){var n=$.map(t[s],function(t){return"menus"===s?t.term_id.toString():t.id});return 0<=$.inArray(l,n)},V=function t(e){var l=e.data("item-type"),s=R(l),n=e.data("item-slug");e.find(".js-wpml-ls-available-slots option").each(function(){var t=$(this),e=$.inArray(t.val(),s)>=0,l=t.val();e&&n!==l?t.attr("disabled","disabled"):t.removeAttr("disabled")})},X=function t(){s.on("change",'[type!="text"].js-wpml-ls-trigger-update',function(){var t=$(this).parents(".js-wpml-ls-subform");tt(t)}).on("keyup",'[type="text"].js-wpml-ls-trigger-update',function(){var t=$(this).parents(".js-wpml-ls-subform");tt(t)}).on("keyup",".js-wpml-ls-additional-css",function(){var t="wpml-ls-inline-styles-additional-css",e=$('<style id="'+t+'" type="text/css">'+$(this).val()+"</style>");$("#"+t).replaceWith(e)})},Y=function e(){s.on("change",".js-wpml-ls-template-selector",function(){var e=$(this).val(),l=$(this).closest(".js-wpml-ls-subform"),s=t.templates[e].force_settings;l.find(".js-wpml-ls-to-include input").prop("disabled",!1),jQuery.each(s,function(t,e){1===e?l.find(".js-wpml-ls-setting-"+t).attr("checked","checked").prop("disabled",!0):l.find(".js-wpml-ls-setting-"+t).removeAttr("checked").prop("disabled",!0)})})},Z=function t(){s.on("change",".js-wpml-ls-menu-is-hierarchical",function(){var t=parseInt($(this).val()),e=$(this).closest(".js-wpml-ls-subform"),l=e.find(".js-wpml-ls-setting-display_link_for_current_lang");l.prop("disabled",!1),1===t&&l.attr("checked","checked").prop("disabled",!0)})},tt=_.debounce(function(e){$(".js-wpml-ls-dialog-save").prop("disabled",!0);var l=e.find(".js-wpml-ls-preview");if(l.length>0){nt(l);var s=st(e);wp.ajax.send({data:{action:"wpml-ls-update-preview",nonce:t.nonce,slot_settings:s},success:function t(e){l.empty(),ot(e.styles),rt(e.css),pt(e.js),it(l,e.html)},error:function t(e){it(l,e,0,"error")}})}},500),et=function t(){e.on("click",".js-wpml-ls-save-settings",function(t){t.preventDefault(),lt($(this))})},lt=_.debounce(function(l,s){var n=l.closest(".js-wpml-ls-option").find(".js-wpml-ls-messages"),i=st(e);0===n.length&&(n=l.closest(".js-wpml-ls-section").find(".js-wpml-ls-messages")),n.empty(),nt(n),wp.ajax.send({data:{action:"wpml-ls-save-settings",nonce:t.nonce,settings:i},success:function t(e){it(n,e,2500,"updated"),"function"==typeof s&&s()},error:function t(e){it(n,e,2500,"error")}})},500),st=function t(e){var l=e.find(":input:disabled").removeAttr("disabled"),s=e.find("input, select, textarea").serialize();return l.attr("disabled","disabled"),s},nt=function t(e){$(".js-wpml-ls-messages").removeClass("success error").hide().empty(),e.siblings(".spinner").addClass("is-active")},it=function t(e,l,s,n){e.siblings(".spinner").removeClass("is-active"),e.removeClass("updated notice error"),n&&e.addClass(n),e.html(l).fadeIn(),s&&e.delay(s).fadeOut(),$(".js-wpml-ls-dialog-save").prop("disabled",!1)},ot=function t(e){if($("#"+i).remove(),e){var l;l=e instanceof jQuery?e:$($.parseHTML(e)).first(),l.attr("id",i),$("#"+n).before(l)}},at=function t(e,l){var s=$("#"+i).clone(),o="wpml-ls-inline-styles-"+e+"-"+l,a=$("#"+o);s.attr("id",o),a.length?a.replaceWith(s):$("#"+n).before(s)},rt=function t(e){var l,s;if("undefined"!==(void 0===e?"undefined":_typeof(e))&&null!==e)for(l=0;l<e.length;l++)s=$('link[href="'+e[l]+'"]'),0===s.length&&(s=$("<link>"),s.attr("rel","stylesheet"),s.attr("type","text/css"),s.attr("media","all"),s.attr("href",e[l]),s.prependTo("head"))},pt=function t(e){var l,s;if("undefined"!==(void 0===e?"undefined":_typeof(e))&&null!==e)for(l=0;l<e.length;l++)s=$('script[src="'+e[l]+'"]'),0===s.length&&(s=$("<script></script>"),s.attr("type","text/javascript"),s.attr("src",e[l]),s.prependTo("head"))};return{init:r}}(jQuery,wpml_language_switcher_admin),jQuery(document).ready(function(){WPML_core.languageSwitcher.init()});
//# sourceMappingURL=./language-switchers-settings.min.js.map