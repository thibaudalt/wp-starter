{"version":3,"sources":["../js/language-switchers-settings.js"],"names":["WPML_core","languageSwitcher","$","wpml_ls","form","dialogBox","formAndDialogBox","additionalCssStyleId","dialogInlineStyleId","currentItemSlug","slotInlineStylesBackup","init","add","maybeInitAdditionalCssStyle","initDialogNode","initColorPicker","initLanguageSortable","attachEvents","openDialogFromHash","document","trigger","attachAutoSaveEvents","attachToggleEvents","attachTooltipEvents","attachDialogEvents","attachRowActionEvents","attachSelectedSlotChangeEvents","attachPresetColorsEvent","attachTemplateChangeEvents","attachMenuHierarchicalEvents","attachUpdatePreviewEvents","attachSaveClickEvents","fixSelectedOption","forceRefreshOnBrowserBackButton","setupWizardNextEvent","preventClickOnPreviewLinks","length","style","attr","appendTo","on","updateSettings","this","triggerNode","messageWrapper","closest","find","showUpdatedContent","strings","leave_text_box_to_save","targetNode","data","slideToggle","complete","is","addClass","removeClass","repositionDialog","nextAll","unwrap","remove","e","preventDefault","openTooltip","sortable","stop","dialog","dialogClass","width","modal","autoOpen","draggable","resizable","css","pointer","attachDialogScrollEvent","updateDialogInlineStyle","window","resize","resizeWindowEvent","item","getItemFromHash","section","type","row","getItemRow","animate","scrollTop","offset","top","subform","prepareTemplateSubform","slug","cloneSubformIntoDialog","hashParts","location","hash","substring","split","inArray","parent","itemTypeSelector","itemSlugSelector","_","debounce","winH","height","my","at","of","preview","has_two_columns","has_minimal_height","position","off","node","wpColorPicker","change","target","parents","updatePreview","clear","restoreInlineStyles","prop","replaceDialogSubformIntoOrigin","hasClass","confirm","confirmation_item_remove","rowNode","itemType","fadeOut","updateSlotSectionStatus","newSlug","val","isSlotAllowed","replaceSubformElementsAttributes","resetColorpickers","each","nodeClone","clone","empty","html","preselectSlot","selector","pickerSets","colors","color_schemes","values","k","v","inputTags","selectedVal","removeAttr","input","reload","submit","href","replace","content","link_text","link_url","link_target","pointerClass","edge","align","show","event","t","close","buttons","bind","element","subformClone","append","prepareSlotInlineStyles","updateAvailableSlotsSelector","inlineStyles","detach","jQuery","before","selectedSlot","appendNewRowAndSubform","updateRowAndSubform","missingSlotWarning","updateStaticSlot","numItems","numAllowed","map","n","i","fadeIn","siblings","wrapper","replaceWith","copyDialogInlineStyleToSlot","updateRowOnItemSlotChange","tplString","trim","newRow","parseHTML","hide","newRowId","newTitle","name","addBack","oldSlug","el","getUsedSlots","slotSlugs","push","slot","allowedSlots","term_id","toString","id","alreadyUsed","selectedOption","optionNode","usedOption","currentOption","styleId","newStyleNode","selected","force","templates","force_settings","isHierarchical","parseInt","includeCurrentLangInput","showSpinner","previewData","getSerializedSettings","wp","ajax","send","action","nonce","slot_settings","success","styles","buildCSSLinks","buildJSScripts","js","error","successCallback","settings","disabled","serialize","delay","newDialogStyle","first","dialogStyleClone","targetId","targetStyle","linkTag","_typeof","prependTo","jsTag","wpml_language_switcher_admin","ready"],"mappings":"mOAEIA,UAAYA,aAEhBA,WAAUC,iBAAoB,SAAUC,EAAGC,GAS1C,GAAIC,GACHC,EACAC,EACAC,EAAuB,uCACvBC,EAAuB,+BACvBC,EACAC,EAEGC,EAAO,QAAPA,KACHP,EAAiBF,EAAE,0BACnBG,EAAmBH,EAAE,mBACrBI,EAAmBF,EAAKQ,IAAIP,GAE5BQ,IACAC,IACAC,IACAC,IACAC,IACAC,IACAhB,EAAEiB,UAAUC,QAAQ,yBAGjBH,EAAe,QAAfA,KACHI,IACAC,IACAC,IACAC,IACAC,IACAC,IACAC,IACAC,IACAC,IACAC,IACAC,KACAC,IACAC,IACAC,IACAC,KAGGtB,EAA8B,QAA9BA,KACH,GAAIX,EAAE,IAAMK,GAAsB6B,OAAS,EAAG,CAC7C,GAAIC,GAAQnC,EAAE,UACdmC,GAAMC,KAAK,KAAM/B,GACjB8B,EAAME,SAASrC,EAAE,WAIfmB,EAAuB,QAAvBA,KACHf,EAAiBkC,GAAG,SAAU,2BAA4B,WACzDC,GAAevC,EAAEwC,SAGlBpC,EAAiBkC,GAAG,QAAS,gCAAiC,WAC7D,GAAIG,GAAczC,EAAEwC,MACnBE,EAAiBD,EAAYE,QAAQ,sBAAsBC,KAAK,uBAEjEC,IAAmBH,EAAgBzC,EAAQ6C,QAAQC,uBAAyB,EAAG,aAI7E3B,EAAqB,QAArBA,KACHhB,EACEkC,GAAG,QAAS,0BAA2B,WACvC,GAAIG,GAAczC,EAAEwC,MAChBQ,EAAchD,EAAEyC,EAAYQ,KAAK,UAErCD,GAAWE,aACVC,SAAU,QAAAA,KACNH,EAAWI,GAAG,aAChBX,EAAYY,SAAS,QACrBL,EAAWJ,KAAK,wBAAwB1B,QAAQ,UAEhDuB,EAAYa,YAAY,QAEzBC,SAKFjB,GAAG,QAAS,0BAA2B,WACvC,GAAIU,GAAahD,EAAEwC,MAAMgB,QAAQ,4BAGjC,OAFAxD,GAAEwC,MAAMI,KAAK,SAASa,SAASb,KAAK,oBAAoBc,SACxDV,EAAWE,eACJ,KAIN7B,EAAsB,QAAtBA,KACHjB,EAAiBkC,GAAG,gBAAiB,2BAA4B,SAASqB,GACzEA,EAAEC,iBACFC,EAAY7D,EAAEwC,UAIZ1B,EAAuB,QAAvBA,KACHd,EAAE,4BAA4B8D,UAC7BC,KAAM,QAAAA,KACLxB,GAAevC,EAAEwC,WAKhB5B,EAAiB,QAAjBA,KACHT,EAAU6D,QACRC,YAAa,6CACbC,MAAO,MACPC,OAAa,EACbC,UAAa,EACbC,WAAa,EACbC,WAAa,IAEbhC,GAAG,aAAc,WACjBtC,EAAE,QAAQuE,IAAI,WAAY,UAC1BvE,EAAE,8BAA8BwE,QAAQ,SACxCjB,IACAkB,MAEAnC,GAAG,cAAe,WAClBtC,EAAE,QAAQuE,IAAI,WAAY,IAC1BvE,EAAE,8BAA8BwE,QAAQ,SACxCE,OAGF1E,EAAE2E,QAAQC,OAAOC,IAGd7D,EAAqB,QAArBA,KACH,GAAI8D,GAAOC,GAEX,IAAID,EAAM,CACT,GAAIE,GAAUhF,EAAE,2BAA6B8E,EAAKG,MACjDC,EAAUC,EAAWL,EAEtB9E,GAAE,cAAcoF,SACfC,UAAWL,EAAQM,SAASC,KAC1B,EAAG,WACL,GAAIC,EAEJ,IAAIN,EACHM,EAAUN,EAAItC,KAAK,2BACb,CACN,GAAII,GAAahD,EAAE,gBAAkB8E,EAAKG,KAAO,YACjDO,GAAUC,EAAuBzC,GACjCzC,EAAkBuE,EAAKY,KAGxBC,EAAuBH,OAKtBT,EAAkB,QAAlBA,KACH,GAAIa,GAAYjB,OAAOkB,SAASC,KAAKC,UAAU,GAAGC,MAAM,KACvDlB,EAAO,KACPG,EAAOW,EAAU,IAAM,GACvBF,EAAOE,EAAU,IAAM,EAWxB,OATI,IAAK5F,EAAEiG,QAAQhB,GAAO,QAAS,WAAY,cAC9CH,GACCG,KAAQA,EACRS,KAAQA,GAGTQ,OAAOL,SAASC,KAAO,IAGjBhB,GAGJK,EAAa,QAAbA,GAAsBL,GACzB,GAAIqB,GAAmB,mBAAqBrB,EAAKG,KAAO,IACvDmB,EAAmBtB,EAAKY,KAAO,mBAAqBZ,EAAKY,KAAO,IAAM,GACtER,EAAmBlF,EAAE,KAAOmG,EAAmBC,EAEhD,OAAO,KAAMlB,EAAIhD,OAASgD,EAAM,MAG7BL,EAAoBwB,EAAEC,SAAS,WAClC/C,IACAkB,KACE,KAEClB,EAAmB,QAAnBA,KACH,GAAIgD,GAAOvG,EAAE2E,QAAQ6B,SAAW,GAChCrG,GAAU6D,OAAO,SAAU,YAAauC,GAExCpG,EAAU6D,OAAO,SAAU,YAC1ByC,GAAI,SACJC,GAAI,SACJC,GAAIhC,UAIFF,EAA0B,QAA1BA,KACH,GAAImC,GAAUzG,EAAUyC,KAAK,+BAC5BiE,EAAkB1G,EAAU+D,QAAU,IACtC4C,EAAsBF,EAAQJ,SAAW,IAAOrG,EAAUqG,QAE3DM,GAAqBA,GAAuBD,GAAmBD,EAAQJ,SAAWrG,EAAUqG,SAExFM,EACH3G,EAAUmC,GAAG,iBAAkB,WAC9BnC,EAAUyC,KAAK,+BAA+B2B,KAC7CwC,SAAU,WACVxB,IAAKpF,EAAUkF,gBAIjBlF,EACE6G,IAAI,kBACJpE,KAAK,+BAA+B2B,KACpCwC,SAAU,WACVxB,IAAK,KAKL1E,EAAkB,QAAlBA,GAA2BoG,GAC9BA,EAAOA,GAAQ/G,EACf+G,EAAKrE,KAAK,2BAA2BsE,eACpCC,OAAQ,QAAAA,GAASxD,GAChB,GAAI6B,GAAUxF,EAAE2D,EAAEyD,QAAQC,QAAQ,sBAClCC,IAAc9B,IAEf+B,MAAO,QAAAA,GAAS5D,GACf,GAAI6B,GAAUxF,EAAE2D,EAAEyD,QAAQC,QAAQ,sBAClCC,IAAc9B,OAKblE,EAAqB,QAArBA,KACHtB,EAAE,4BAA4BsC,GAAG,QAAS,SAASqB,GAClDA,EAAEC,iBACF4D,IACArH,EAAU6D,OAAO,WAGlBhE,EAAE,2BAA2BsC,GAAG,QAAS,SAASqB,GACjDA,EAAEC,iBACF5D,EAAEwC,MAAMiF,KAAK,YAAY,EACzB,IAAIjC,GAAUrF,EAAUyC,KAAK,sBAC7B8E,GAA+BlC,KAGhCxF,EAAE,2BAA2BsC,GAAG,QAAS,SAASqB,GACjDA,EAAEC,gBAEF,IAAI4B,GACHxC,EAAahD,EAAEA,EAAE2D,EAAEyD,QAAQnE,KAAK,UAGhCuC,GADGxC,EAAW2E,SAAS,uBACblC,EAAuBzC,GAEvBA,EAAWJ,KAAK,uBAG3B+C,EAAuBH,MAIrBjE,EAAwB,QAAxBA,KACHvB,EAAE,yBACAsC,GAAG,QAAS,uBAAwB,SAASqB,GAC7CA,EAAEC,gBAEF,IAAIZ,GAAahD,EAAEA,EAAE2D,EAAEyD,QAAQC,QAAQ,sBACtC7B,EAAaxC,EAAWJ,KAAK,sBAE9B+C,GAAuBH,KAEvBlD,GAAG,QAAS,yBAA0B,SAASqB,GAE/C,GADAA,EAAEC,iBACEgE,QAAQ3H,EAAQ6C,QAAQ+E,0BAA2B,CACtD,GAAIC,GAAW9H,EAAEwC,MAAM6E,QAAQ,qBAC9BU,EAAWD,EAAQ7E,KAAK,YAEzB6E,GAAQlF,KAAK,yDAAyDc,SAEtEnB,GAAeuF,EAAS,WACvBA,EAAQE,QAAQ,IAAK,WACpBF,EAAQpE,SACRuE,EAAwBF,WAO1BvG,EAAiC,QAAjCA,KACHpB,EAAiBkC,GAAG,SAAU,8BAA+B,WAC5D,GAAI4F,GAAUlI,EAAEwC,MAAM2F,MACrB3C,EAAUxF,EAAEwC,MAAMG,QAAQ,uBAC1BoF,EAAWvC,EAAQvC,KAAK,YAEzBjD,GAAEwC,MAAMc,YAAY,oBAEhB8E,EAAcF,EAASH,IAC1BM,EAAiC7C,EAAS0C,MAKzCI,EAAoB,QAApBA,GAA6BrB,GAChCA,EAAKrE,KAAK,2BAA2B2F,KAAM,WAC1C,GAAIC,GAAaxI,EAAEwC,MAAMiG,OACXzI,GAAEwC,MAAM6E,QAAQ,mCAEnBqB,QAAQC,KAAKH,KAGzB3H,EAAgBoG,IAGb2B,EAAgB,QAAhBA,GAAyBpD,GAC5B,GAAIjF,EAAiB,CACpB,GAAIsI,GAAW,6CAA+CtI,EAAkB,IAChFiF,GAAQ5C,KAAKiG,GAAUzG,KAAK,WAAY,YACxC7B,EAAkB,OAIhBkB,EAA0B,QAA1BA,KACHrB,EAAiBkC,GAAG,SAAU,iCAAkC,WAC/D,GAAIoD,GAAO1F,EAAEwC,MAAM2F,MAClB3C,EAAUxF,EAAEwC,MAAM6E,QAAQ,sBAE3B,IAAI3B,EAAM,CACT,GAAIoD,GAAa9I,EAAEwC,MAAM6E,QAAQ,4BAChC0B,EAAa9I,EAAQ+I,cAAetD,GAAOuD,MAE5CjJ,GAAEuI,KAAKQ,EAAQ,SAASG,EAAGC,GAC1B,GAAIC,GAAYN,EAAWlG,KAAK,qBAAuBsG,EACvDE,GAAUhH,KAAK,QAAS+G,GACxBC,EAAU/B,QAAQ,wBAAwBzE,KAAK,oBAAoB2B,IAAI,mBAAoB4E,KAG5F7B,GAAc9B,OAKb1D,EAAoB,QAApBA,KAEH1B,EAAiBkC,GAAG,SAAU,SAAU,WACvC,GAAI+G,GAAcrJ,EAAEwC,MAAM2F,KAC1BnI,GAAE,SAAUwC,MAAM8G,WAAW,YAC7BtJ,EAAE,iBAAmBqJ,EAAc,KAAM7G,MAAMJ,KAAK,WAAY,eAO9DL,EAAkC,QAAlCA,KACH,GAAIwH,GAAQvJ,EAAE,0CAEK,SAAhBuJ,EAAMpB,MACRtC,SAAS2D,QAAO,GAEhBD,EAAMpB,IAAI,QAIRnG,EAAuB,QAAvBA,KACH9B,EAAKuJ,OAAO,SAAS9F,GACpBA,EAAEC,iBAEF1D,EAAK0C,KAAK,qCAAqCuF,IAAI,GAEnD5F,GAAerC,EAAM,WACpB2F,SAAS6D,KAAO7D,SAAS6D,KAAKC,QAAQ,MAAM,SAK3C1H,EAA6B,QAA7BA,KACHjC,EAAE,uBAAuBsC,GAAG,QAAS,SAASqB,GAC7CA,EAAEC,oBAIAC,EAAc,QAAdA,GAAuBpB,GAC1B,GAAImH,GAAUnH,EAAYQ,KAAK,WAC3B4G,EAAYpH,EAAYQ,KAAK,aAC7B6G,EAAWrH,EAAYQ,KAAK,YAC5B8G,EAActH,EAAYQ,KAAK,cAEnC,IAAI4G,EAAU3H,OAAS,EAAG,CACD,IAApB4H,EAAS5H,SACZ4H,EAAW,IAGZF,IAAW,oBAAsBE,EAAW,MADlB,WAAaC,EAAc,KACoB,IACzEH,GAAWC,EACXD,GAAW,OAGZ5J,EAAE,8BAA8BwE,QAAQ,SAErC/B,EAAYP,QAAU0H,IACxBnH,EAAYY,SAAS,6BACrBZ,EAAY+B,SACXwF,aAAe,qCACfJ,QAAeA,EACf7C,UACCkD,KAAO,SACPC,MAAO,QAERC,KAAM,QAAAA,GAASC,EAAOC,GACrBA,EAAE7F,QAAQD,IAAI,aAAc,UAE7B+F,MAAO,QAAAA,GAASF,EAAOC,GACtBA,EAAE7F,QAAQD,IAAI,aAAc,MAE7BgG,QAAS,QAAAA,GAAUH,EAAOC,GAGzB,MAFarK,GAAE,wCAEDwK,KAAM,gBAAiB,SAAS7G,GAC7CA,EAAEC,iBACFyG,EAAEI,QAAQjG,QAAQ,cAIlBA,QAAQ,UAITmB,EAAyB,QAAzBA,GAAkCH,GACrC,GAAIkF,GAAelF,EAAQiD,OAAM,EAEjCtI,GAAUyC,KAAK,4BAA4B8F,QAAQiC,OAAOD,GAEvD,KAAOA,EAAa9H,KAAK,uBAAuB+F,QAClDrB,GAAcoD,GAGfE,EAAwBpF,GACxBqF,EAA6BH,GAC7BpC,EAAkBoC,GAClB9B,EAAc8B,GAEdvK,EAAU6D,OAAO,SAAU,QAAS0G,EAAazH,KAAK,UACpDe,OAAO,SAGN4G,EAA0B,QAA1BA,GAAmCpF,GACtC,GAAIP,GAAOO,EAAQvC,KAAK,aACpByC,EAAOF,EAAQvC,KAAK,YAExByC,GAAO,SAAWA,EAAO,SAAWA,CACpC,IAAIoF,GAAe9K,EAAE,0BAA4BiF,EAAO,IAAMS,EAC9DlF,GAAyBsK,EAAaC,SACtCrG,GAAwBlE,EAAuBiI,UAG5CjB,EAAsB,QAAtBA,KACEhH,YAAkCwK,SAAUxK,EAAuB0B,OAAS,GAChFlC,EAAE,IAAMK,GAAsB4K,OAAOzK,IAInCkH,EAAiC,QAAjCA,GAA0ClC,GAC7C,GAAIkF,GAAelF,EAAQiD,OAAM,GAChCV,EAAevC,EAAQvC,KAAK,YAI7B,IAFAyH,EAAa9H,KAAK,+BAA+B2B,IAAI,MAAO,GAEzD,GAAKvE,EAAEiG,QAAQ8B,GAAW,QAAS,aAAe,CACpD,GAAImD,GAAe1F,EAAQ5C,KAAK,+BAA+BuF,KAE3DC,GAAc8C,EAAcnD,QACe,KAAnC2C,EAAazH,KAAK,aAC5BkI,EAAuBT,GAEvBU,EAAoBV,GAGrBzC,EAAwBF,IAExBsD,EAAmB7F,OAEwB,YAAnCkF,EAAazH,KAAK,cAC3BqI,EAAiBZ,IAIfzC,EAA0B,QAA1BA,GAAmCF,GACtC,GAAI/C,GAAahF,EAAE,2BAA6B+H,GAC/CwD,EAAavG,EAAQpC,KAAK,mBAAmBV,OAC7CsJ,EAAaxL,EAAEyL,IAAIxL,EAAS8H,GAAY,SAAS2D,EAAGC,GAAK,MAAOA,KAAMzJ,MAEtD,KAAbqJ,EACHvG,EAAQpC,KAAK,yBAAyBoF,UAEtChD,EAAQpC,KAAK,yBAAyBgJ,SAGnCL,IAAaC,EAChBxG,EAAQpC,KAAK,iCAAiCR,KAAK,WAAY,YAC7DyJ,SAAS,+BAA+BvI,YAAY,UAEtD0B,EAAQpC,KAAK,iCAAiC0G,WAAW,YACvDuC,SAAS,+BAA+BxI,SAAS,WAIjDiI,EAAmB,QAAnBA,GAA4B9F,GAC/B,GAAIsG,GAAU9L,EAAE,IAAMwF,EAAQvC,KAAK,cAClCyC,EAAUF,EAAQvC,KAAK,YAExB6I,GAAQlJ,KAAK,uBAAuBmJ,YAAYvG,GAEhDwG,GAA4B,UAAWtG,GAEvCnD,GAAeuJ,EAAS,WACvB3L,EAAUyC,KAAK,4BAA4B8F,QAC3CvI,EAAU6D,OAAO,YAIfoH,EAAsB,QAAtBA,GAA+B5F,GAClC,GAAIN,GAAWlF,EAAE,IAAMwF,EAAQvC,KAAK,cACnC8E,EAAWvC,EAAQvC,KAAK,aACxByC,EAAWF,EAAQ5C,KAAK,+BAA+BuF,KAExDjD,GAAItC,KAAK,uBAAuBmJ,YAAYvG,GAEzCN,EAAI9C,KAAK,QAAU,WAAa2F,EAAU,QAAUrC,GACtDuG,EAA0B/G,EAAK6C,EAAUrC,GAG1CsG,GAA4BjE,EAAUrC,GAEtCnD,GAAe2C,EAAK,WACnB/E,EAAUyC,KAAK,4BAA4B8F,QAC3CvI,EAAU6D,OAAO,YAIfmH,EAAyB,QAAzBA,GAAkC3F,GACrC,GAAIuC,GAAWvC,EAAQvC,KAAK,aAC3ByC,EAAWF,EAAQ5C,KAAK,yBAA2BmF,GAAUI,KAE9DE,GAAiC7C,EAASE,EAE1C,IAAIwG,GAAYlM,EAAEmM,KAAKnM,EAAE,gBAAkB+H,EAAW,iBAAiBY,QACtEyD,EAAYpM,EAAEA,EAAEqM,UAAUH,GAE3BE,GAAOxJ,KAAK,uBAAuBmJ,YAAYvG,GAC/CyG,EAA0BG,EAAQrE,EAAUrC,GAC5C0G,EAAOE,OAAOjK,SAASnC,EAAK0C,KAAK,sBAAwBmF,EAAW,aAAaoC,KAAK,KAEtF6B,GAA4BjE,EAAUrC,GAEtCnD,GAAe6J,EAAQ,WACtBjM,EAAUyC,KAAK,4BAA4B8F,QAC3CvI,EAAU6D,OAAO,YAIfqH,EAAqB,QAArBA,GAA8B7F,GACjCA,EAAQ5C,KAAK,+BAA+BS,SAAS,oBACrDlD,EAAUiF,SAASC,UAAU,GAAI,KACjCrF,EAAE,2BAA2ByH,KAAK,YAAY,IAG3CwE,EAA4B,QAA5BA,GAAqC/G,EAAK6C,EAAUrC,GACvD,GAAI6G,GAAW,WAAaxE,EAAU,QAAUrC,EAC/C8G,EAAWvM,EAAS8H,GAAYrC,GAAO+G,IAExCvH,GAAI9C,KAAK,KAAMmK,GACfrH,EAAIjC,KAAK,YAAa8E,GACtB7C,EAAItC,KAAK,uBAAuB8J,UAAUzJ,KAAK,YAAayC,GAC5DR,EAAItC,KAAK,uBAAuBK,KAAK,YAAasJ,GAClDrH,EAAItC,KAAK,yBAAyB+F,KAAK6D,IAGpCnE,EAAmC,QAAnCA,GAA4C7C,EAAS0C,GACxD,GAAI9F,GAAW,GACd2F,EAAWvC,EAAQvC,KAAK,aACxB0J,EAAWnH,EAAQvC,KAAK,YAEzBuC,GAAQ5C,KAAK,iBAAiB2F,KAAK,SAASoD,EAAGiB,GAC9CxK,EAAOpC,EAAE4M,GAAIxK,KAAK,QACE,gBAATA,IACVpC,EAAE4M,GAAIxK,KAAK,OAAQA,EAAKuH,QAAQ5B,EAAW,IAAM4E,EAAS,IAAK5E,EAAW,IAAMG,EAAS,MAItE,iBADpB9F,EAAOpC,EAAE4M,GAAIxK,KAAK,QAEjBpC,EAAE4M,GAAIxK,KAAK,KAAMA,EAAKuH,QAAQgD,EAASzE,MAIzC1C,EAAQ5C,KAAK,SAAS2F,KAAK,SAASoD,EAAGiB,GAElB,iBADpBxK,EAAOpC,EAAE4M,GAAIxK,KAAK,SAEjBpC,EAAE4M,GAAIxK,KAAK,MAAOA,EAAKuH,QAAQgD,EAASzE,OAKvCzC,EAAyB,QAAzBA,GAAkCzC,GACrC,GAAIkJ,GAAYlM,EAAEmM,KAAKnJ,EAAW2F,QACjCnD,EAAYxF,EAAEA,EAAEqM,UAAUH,GAI3B,OAFArB,GAA6BrF,GAEtBA,GAGJqH,EAAe,QAAfA,GAAyB5H,GAC5B,GAAI6H,KAKJ,OAJA9M,GAAE,sBAAwBiF,EAAO,oBAAoBsD,KAAM,WAC1DuE,EAAUC,KAAK/M,EAAEwC,MAAMS,KAAK,gBAGtB6J,GAGJ1E,EAAgB,QAAhBA,GAAyB4E,EAAMjF,GAClC,GAAIkF,GAAejN,EAAEyL,IAAIxL,EAAS8H,GAAY,SAAS6E,GACtD,MAAoB,UAAb7E,EAAuB6E,EAAGM,QAAQC,WAAaP,EAAGQ,IAG1D,OAAO,IAAKpN,EAAEiG,QAAQ+G,EAAMC,IAGzBpC,EAA+B,QAA/BA,GAAwCrF,GAC3C,GAAIuC,GAAsBvC,EAAQvC,KAAK,aACtCoK,EAAsBR,EAAa9E,GACnCuF,EAAsB9H,EAAQvC,KAAK,YACbuC,GAAQ5C,KAAK,sCAEhB2F,KAAK,WACxB,GAAIgF,GAAgBvN,EAAEwC,MACrBgL,EAAgBxN,EAAEiG,QAAQsH,EAAWpF,MAAOkF,IAAgB,EAC5DI,EAAgBF,EAAWpF,KAExBqF,IAAcF,IAAmBG,EACpCF,EAAWnL,KAAK,WAAY,YAE5BmL,EAAWjE,WAAW,eAKrB1H,EAA4B,QAA5BA,KACHxB,EACEkC,GAAG,SAAU,2CAA4C,WACzD,GAAIkD,GAAUxF,EAAEwC,MAAM6E,QAAQ,sBAC9BC,IAAc9B,KAEdlD,GAAG,QAAS,0CAA2C,WACvD,GAAIkD,GAAUxF,EAAEwC,MAAM6E,QAAQ,sBAC9BC,IAAc9B,KAEdlD,GAAG,QAAS,6BAA8B,WAC1C,GAAIoL,GAAe,uCAClBC,EAAe3N,EAAE,cAAgB0N,EAAU,qBAAuB1N,EAAEwC,MAAM2F,MAAQ,WAEnFnI,GAAE,IAAM0N,GAAS3B,YAAY4B,MAI5BjM,EAA6B,QAA7BA,KACHtB,EAAiBkC,GAAG,SAAU,gCAAiC,WAC9D,GAAIsL,GAAW5N,EAAEwC,MAAM2F,MACtB3C,EAAWxF,EAAEwC,MAAMG,QAAQ,uBAC3BkL,EAAW5N,EAAQ6N,UAAWF,GAAWG,cAE1CvI,GAAQ5C,KAAK,gCAAgC6E,KAAK,YAAY,GAE9DuD,OAAOzC,KAAKsF,EAAO,SAAS3E,EAAGC,GACrB,IAANA,EACF3D,EAAQ5C,KAAK,uBAAyBsG,GAAG9G,KAAK,UAAW,WAAWqF,KAAK,YAAY,GAErFjC,EAAQ5C,KAAK,uBAAyBsG,GAAGI,WAAW,WAAW7B,KAAK,YAAY,QAMhF9F,EAA+B,QAA/BA,KACHvB,EAAiBkC,GAAG,SAAU,mCAAoC,WACjE,GAAI0L,GAA0BC,SAASjO,EAAEwC,MAAM2F,OAC9C3C,EAA0BxF,EAAEwC,MAAMG,QAAQ,uBAC1CuL,EAA0B1I,EAAQ5C,KAAK,oDAExCsL,GAAwBzG,KAAK,YAAY,GAEnB,IAAnBuG,GACFE,EAAwB9L,KAAK,UAAW,WAAWqF,KAAK,YAAY,MAKnEH,GAAgBjB,EAAEC,SAAU,SAASd,GACxCxF,EAAE,2BAA2ByH,KAAK,YAAY,EAC9C,IAAIb,GAAUpB,EAAQ5C,KAAK,sBAE3B,IAAGgE,EAAQ1E,OAAS,EAAG,CACtBiM,GAAYvH,EACZ,IAAIwH,GAAcC,GAAsB7I,EAExC8I,IAAGC,KAAKC,MACPvL,MACCwL,OAAe,yBACfC,MAAezO,EAAQyO,MACvBC,cAAeP,GAEhBQ,QAAU,QAAAA,GAAU3L,GACnB2D,EAAQ8B,QACRhE,GAAwBzB,EAAK4L,QAC7BC,GAAc7L,EAAKsB,KACnBwK,GAAe9L,EAAK+L,IACpBnM,GAAmB+D,EAAS3D,EAAK0F,OAElCsG,MAAO,QAAAA,GAAUhM,GAChBJ,GAAmB+D,EAAS3D,EAAM,EAAG,cAItC,KAECpB,GAAwB,QAAxBA,KACH3B,EAAKoC,GAAG,QAAS,4BAA6B,SAASqB,GACtDA,EAAEC,iBACFrB,GAAevC,EAAEwC,UAIfD,GAAiB8D,EAAEC,SAAS,SAAUwF,EAASoD,GAClD,GAAIxM,GAAiBoJ,EAAQnJ,QAAQ,sBAAsBC,KAAK,wBAC/DuM,EAAiBd,GAAsBnO,EAEX,KAA1BwC,EAAeR,SACjBQ,EAAiBoJ,EAAQnJ,QAAQ,uBAAuBC,KAAK,yBAG9DF,EAAegG,QACfyF,GAAYzL,GAEZ4L,GAAGC,KAAKC,MACPvL,MACCwL,OAAU,wBACVC,MAAUzO,EAAQyO,MAClBS,SAAUA,GAEXP,QAAU,QAAAA,GAAU3L,GACnBJ,GAAmBH,EAAgBO,EAAM,KAAM,WAEjB,kBAApBiM,IACTA,KAGFD,MAAO,QAAAA,GAAUhM,GAChBJ,GAAmBH,EAAgBO,EAAM,KAAM,aAG/C,KAECoL,GAAwB,QAAxBA,GAAiCnO,GACpC,GAAIkP,GAAWlP,EAAK0C,KAAK,mBAAmB0G,WAAW,YACtD6F,EAAWjP,EAAK0C,KAAK,2BAA2ByM,WAIjD,OAFAD,GAAShN,KAAK,WAAW,YAElB+M,GAGJhB,GAAc,QAAdA,GAAuBrC,GAC1B9L,EAAE,wBAAwBsD,YAAY,iBAAiBgJ,OAAO5D,QAC9DoD,EAAQD,SAAS,YAAYxI,SAAS,cAGnCR,GAAqB,QAArBA,GAA8BiJ,EAASlC,EAAS0F,EAAOrK,GAC1D6G,EAAQD,SAAS,YAAYvI,YAAY,aAEzCwI,EAAQxI,YAAY,wBAEjB2B,GACF6G,EAAQzI,SAAS4B,GAGlB6G,EAAQnD,KAAKiB,GAASgC,SAEnB0D,GACFxD,EAAQwD,MAAMA,GAAOtH,UAGtBhI,EAAE,2BAA2ByH,KAAK,YAAY,IAG3C/C,GAA0B,QAA1BA,GAAoCmK,GAGvC,GAFC7O,EAAE,IAAMM,GAAqBoD,SAE3BmL,EAAQ,CACV,GAAIU,EAGHA,GADGV,YAAkB7D,QACJ6D,EAEA7O,EAAEA,EAAEqM,UAAUwC,IAASW,QAGzCD,EAAenN,KAAK,KAAM9B,GAC1BN,EAAE,IAAMK,GAAsB4K,OAAOsE,KAInCvD,GAA8B,QAA9BA,GAAwCjE,EAAUrC,GACrD,GAAI+J,GAAmBzP,EAAE,IAAMM,GAAqBmI,QACnDiH,EAAmB,yBAA2B3H,EAAW,IAAMrC,EAC/DiK,EAAmB3P,EAAE,IAAM0P,EAE5BD,GAAiBrN,KAAK,KAAMsN,GAExBC,EAAYzN,OACfyN,EAAY5D,YAAY0D,GAExBzP,EAAE,IAAMK,GAAsB4K,OAAOwE,IAInCX,GAAgB,QAAhBA,GAA0BvK,GAC7B,GAAIoH,GACHiE,CAED,IAAI,mBAAA,KAAOrL,EAAP,YAAAsL,QAAOtL,KAA4B,OAASA,EAC/C,IAAKoH,EAAI,EAAGA,EAAIpH,EAAIrC,OAAQyJ,IAC3BiE,EAAU5P,EAAE,cAAgBuE,EAAIoH,GAAK,MAEjC,IAAMiE,EAAQ1N,SACjB0N,EAAU5P,EAAE,UACZ4P,EAAQxN,KAAK,MAAO,cACpBwN,EAAQxN,KAAK,OAAQ,YACrBwN,EAAQxN,KAAK,QAAS,OACtBwN,EAAQxN,KAAK,OAAQmC,EAAIoH,IACzBiE,EAAQE,UAAU,UAMlBf,GAAiB,QAAjBA,GAA2BC,GAC9B,GAAIrD,GACHoE,CAED,IAAI,mBAAA,KAAOf,EAAP,YAAAa,QAAOb,KAA2B,OAASA,EAC9C,IAAKrD,EAAI,EAAGA,EAAIqD,EAAG9M,OAAQyJ,IAC1BoE,EAAQ/P,EAAE,eAAiBgP,EAAGrD,GAAK,MAE/B,IAAMoE,EAAM7N,SACf6N,EAAQ/P,EAAE,qBACV+P,EAAM3N,KAAK,OAAQ,mBACnB2N,EAAM3N,KAAK,MAAO4M,EAAGrD,IACrBoE,EAAMD,UAAU,SAMpB,QACCrP,KAAQA,IAGNuK,OAAQgF,8BAEZhF,OAAO/J,UAAUgP,MAAM,WAGtBnQ,UAAUC,iBAAiBU","file":"language-switchers-settings.min.js","sourcesContent":["/*jshint browser:true, devel:true */\n/*global jQuery, wp, document, wpml_language_switcher_admin, _, iclSaveForm_success_cb, iclSaveForm */\nvar WPML_core = WPML_core || {};\n\nWPML_core.languageSwitcher = (function( $, wpml_ls ) {\n\t\"use strict\";\n\n\t/** @namespace wpml_ls.strings */\n\t/** @namespace wpml_ls.strings.confirmation_item_remove */\n\t/** @namespace wpml_ls.color_schemes */\n\t/** @namespace wpml_ls.strings.table_no_item */\n\t/** @namespace wpml_ls.templates */\n\n\tvar form,\n\t\tdialogBox,\n\t\tformAndDialogBox,\n\t\tadditionalCssStyleId = 'wpml-ls-inline-styles-additional-css',\n\t\tdialogInlineStyleId  = 'wpml-ls-inline-styles-dialog',\n\t\tcurrentItemSlug,\n\t\tslotInlineStylesBackup;\n\n\tvar init = function () {\n\t\tform         \t = $('#wpml-ls-settings-form');\n\t\tdialogBox        = $('#wpml-ls-dialog');\n\t\tformAndDialogBox = form.add(dialogBox);\n\n\t\tmaybeInitAdditionalCssStyle();\n\t\tinitDialogNode();\n\t\tinitColorPicker();\n\t\tinitLanguageSortable();\n\t\tattachEvents();\n\t\topenDialogFromHash();\n\t\t$(document).trigger('wpml_ls_admin_loaded');\n\t};\n\n\tvar attachEvents = function () {\n\t\tattachAutoSaveEvents();\n\t\tattachToggleEvents();\n\t\tattachTooltipEvents();\n\t\tattachDialogEvents();\n\t\tattachRowActionEvents();\n\t\tattachSelectedSlotChangeEvents();\n\t\tattachPresetColorsEvent();\n\t\tattachTemplateChangeEvents();\n\t\tattachMenuHierarchicalEvents();\n\t\tattachUpdatePreviewEvents();\n\t\tattachSaveClickEvents();\n\t\tfixSelectedOption();\n\t\tforceRefreshOnBrowserBackButton();\n\t\tsetupWizardNextEvent();\n\t\tpreventClickOnPreviewLinks();\n\t};\n\n\tvar maybeInitAdditionalCssStyle = function() {\n\t\tif ($('#' + additionalCssStyleId).length < 1) {\n\t\t\tvar style = $('<style>');\n\t\t\tstyle.attr('id', additionalCssStyleId);\n\t\t\tstyle.appendTo($('head'));\n\t\t}\n\t};\n\n\tvar attachAutoSaveEvents = function() {\n\t\tformAndDialogBox.on('change', '.js-wpml-ls-trigger-save', function() {\n\t\t\tupdateSettings($(this));\n\t\t});\n\n\t\tformAndDialogBox.on('keyup', '.js-wpml-ls-trigger-need-save', function() {\n\t\t\tvar triggerNode = $(this),\n\t\t\t\tmessageWrapper = triggerNode.closest('.js-wpml-ls-option').find('.js-wpml-ls-messages');\n\n\t\t\tshowUpdatedContent(messageWrapper, wpml_ls.strings.leave_text_box_to_save , 0, 'notice');\n\t\t});\n\t};\n\t\n\tvar attachToggleEvents = function() {\n\t\tformAndDialogBox\n\t\t\t.on('click', '.js-wpml-ls-toggle-slot', function() {\n\t\t\t\tvar triggerNode = $(this);\n\t\t\t\tvar targetNode  = $(triggerNode.data('target'));\n\n\t\t\t\ttargetNode.slideToggle({\n\t\t\t\t\tcomplete: function(){\n\t\t\t\t\t\tif(targetNode.is(':visible')) {\n\t\t\t\t\t\t\ttriggerNode.addClass('open');\n\t\t\t\t\t\t\ttargetNode.find('.js-wpml-ls-row-edit').trigger('click');\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\ttriggerNode.removeClass('open');\n\t\t\t\t\t\t}\n\t\t\t\t\t\trepositionDialog();\n\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t})\n\t\t\t.on('click', '.js-wpml-ls-toggle-once', function() {\n\t\t\t\tvar targetNode = $(this).nextAll('.js-wpml-ls-toggle-target');\n\t\t\t\t$(this).find('label').unwrap().find('.js-arrow-toggle').remove();\n\t\t\t\ttargetNode.slideToggle();\n\t\t\t\treturn false;\n\t\t\t});\n\t};\n\n\tvar attachTooltipEvents = function() {\n\t\tformAndDialogBox.on('click.tooltip', '.js-wpml-ls-tooltip-open', function(e) {\n\t\t\te.preventDefault();\n\t\t\topenTooltip($(this));\n\t\t});\n\t};\n\n\tvar initLanguageSortable = function() {\n\t\t$('#wpml-ls-languages-order').sortable({\n\t\t\tstop: function() {\n\t\t\t\tupdateSettings($(this));\n\t\t\t}\n\t\t});\n\t};\n\n\tvar initDialogNode = function() {\n\t\tdialogBox.dialog({\n\t\t\t\tdialogClass: 'dialog-fixed otgs-ui-dialog wpml-ls-dialog',\n\t\t\t\twidth: '90%',\n\t\t\t\tmodal:       true,\n\t\t\t\tautoOpen:    false,\n\t\t\t\tdraggable:   true,\n\t\t\t\tresizable:   false\n\t\t\t})\n\t\t\t.on('dialogopen', function () {\n\t\t\t\t$('body').css('overflow', 'hidden');\n\t\t\t\t$('.js-wpml-ls-active-tooltip').pointer('close');\n\t\t\t\trepositionDialog();\n\t\t\t\tattachDialogScrollEvent();\n\t\t\t})\n\t\t\t.on('dialogclose', function () {\n\t\t\t\t$('body').css('overflow', '');\n\t\t\t\t$('.js-wpml-ls-active-tooltip').pointer('close');\n\t\t\t\tupdateDialogInlineStyle();\n\t\t\t});\n\n\t\t$(window).resize(resizeWindowEvent);\n\t};\n\n\tvar openDialogFromHash = function() {\n\t\tvar item = getItemFromHash();\n\n\t\tif (item) {\n\t\t\tvar section = $('#wpml-language-switcher-' + item.type),\n\t\t\t\trow     = getItemRow(item);\n\n\t\t\t$('html, body').animate({\n\t\t\t\tscrollTop: section.offset().top\n\t\t\t}, 1, function() {\n\t\t\t\tvar subform;\n\n\t\t\t\tif (row) {\n\t\t\t\t\tsubform = row.find('.js-wpml-ls-subform');\n\t\t\t\t} else {\n\t\t\t\t\tvar targetNode = $('#wpml-ls-new-' + item.type + '-template');\n\t\t\t\t\tsubform = prepareTemplateSubform(targetNode);\n\t\t\t\t\tcurrentItemSlug = item.slug;\n\t\t\t\t}\n\n\t\t\t\tcloneSubformIntoDialog(subform);\n\t\t\t});\n\t\t}\n\t};\n\n\tvar getItemFromHash = function() {\n\t\tvar hashParts = window.location.hash.substring(1).split('/'),\n\t\t\titem = null,\n\t\t\ttype = hashParts[0] || '',\n\t\t\tslug = hashParts[1] || '';\n\n\t\tif (0 <= $.inArray(type, ['menus', 'sidebars', 'statics'])) {\n\t\t\titem = {\n\t\t\t\t'type': type,\n\t\t\t\t'slug': slug\n\t\t\t};\n\n\t\t\tparent.location.hash = '';\n\t\t}\n\n\t\treturn item;\n\t};\n\n\tvar getItemRow = function(item) {\n\t\tvar itemTypeSelector = '[data-item-type=' + item.type + ']',\n\t\t\titemSlugSelector = item.slug ? '[data-item-slug=' + item.slug + ']' : '',\n\t\t\trow              = $('tr' + itemTypeSelector + itemSlugSelector);\n\n\t\treturn 1 === row.length ? row : null;\n\t};\n\n\tvar resizeWindowEvent = _.debounce(function() {\n\t\trepositionDialog();\n\t\tattachDialogScrollEvent();\n\t}, 200);\n\n\tvar repositionDialog = function () {\n\t\tvar winH = $(window).height() - 180;\n\t\tdialogBox.dialog(\"option\", \"maxHeight\", winH);\n\n\t\tdialogBox.dialog(\"option\", \"position\", {\n\t\t\tmy: \"center\",\n\t\t\tat: \"center\",\n\t\t\tof: window\n\t\t});\n\t};\n\n\tvar attachDialogScrollEvent = function() {\n\t\tvar preview = dialogBox.find('.js-wpml-ls-preview-wrapper'),\n\t\t\thas_two_columns = dialogBox.width() > 900,\n\t\t\thas_minimal_height = (preview.height() + 200) < dialogBox.height();\n\n\t\thas_minimal_height = has_minimal_height || (has_two_columns && preview.height() < dialogBox.height());\n\n\t\tif (has_minimal_height) {\n\t\t\tdialogBox.on('scroll.preview', function(){\n\t\t\t\tdialogBox.find('.js-wpml-ls-preview-wrapper').css({\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\ttop: dialogBox.scrollTop()\n\t\t\t\t});\n\t\t\t});\n\t\t} else {\n\t\t\tdialogBox\n\t\t\t\t.off('scroll.preview')\n\t\t\t\t.find('.js-wpml-ls-preview-wrapper').css({\n\t\t\t\t\tposition: 'relative',\n\t\t\t\t\ttop: 0\n\t\t\t\t});\n\t\t}\n\t};\n\n\tvar initColorPicker = function(node) {\n\t\tnode = node || form;\n\t\tnode.find('.js-wpml-ls-colorpicker').wpColorPicker({\n\t\t\tchange: function(e){\n\t\t\t\tvar subform = $(e.target).parents('.js-wpml-ls-subform');\n\t\t\t\tupdatePreview(subform);\n\t\t\t},\n\t\t\tclear: function(e){\n\t\t\t\tvar subform = $(e.target).parents('.js-wpml-ls-subform');\n\t\t\t\tupdatePreview(subform);\n\t\t\t}\n\t\t});\n\t};\n\n\tvar attachDialogEvents = function() {\n\t\t$('.js-wpml-ls-dialog-close').on('click', function(e) {\n\t\t\te.preventDefault();\n\t\t\trestoreInlineStyles();\n\t\t\tdialogBox.dialog('close');\n\t\t});\n\n\t\t$('.js-wpml-ls-dialog-save').on('click', function(e) {\n\t\t\te.preventDefault();\n\t\t\t$(this).prop('disabled', true);\n\t\t\tvar subform = dialogBox.find('.js-wpml-ls-subform');\n\t\t\treplaceDialogSubformIntoOrigin(subform);\n\t\t});\n\n\t\t$('.js-wpml-ls-open-dialog').on('click', function(e) {\n\t\t\te.preventDefault();\n\n\t\t\tvar subform,\n\t\t\t\ttargetNode = $($(e.target).data('target'));\n\n\t\t\tif (targetNode.hasClass('js-wpml-ls-template')) {\n\t\t\t\tsubform = prepareTemplateSubform(targetNode);\n\t\t\t} else {\n\t\t\t\tsubform = targetNode.find('.js-wpml-ls-subform');\n\t\t\t}\n\n\t\t\tcloneSubformIntoDialog(subform);\n\t\t});\n\t};\n\n\tvar attachRowActionEvents = function() {\n\t\t$('.js-wpml-ls-slot-list')\n\t\t\t.on('click', '.js-wpml-ls-row-edit', function(e) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\tvar targetNode = $($(e.target).parents('tr.js-wpml-ls-row')),\n\t\t\t\t\tsubform    = targetNode.find('.js-wpml-ls-subform');\n\n\t\t\t\tcloneSubformIntoDialog(subform);\n\t\t\t})\n\t\t\t.on('click', '.js-wpml-ls-row-remove', function(e) {\n\t\t\t\te.preventDefault();\n\t\t\t\tif (confirm(wpml_ls.strings.confirmation_item_remove)) {\n\t\t\t\t\tvar rowNode  = $(this).parents('tr.js-wpml-ls-row'),\n\t\t\t\t\t\titemType = rowNode.data('item-type');\n\n\t\t\t\t\trowNode.find('.js-wpml-ls-subform input, .js-wpml-ls-subform select').remove();\n\n\t\t\t\t\tupdateSettings(rowNode, function(){\n\t\t\t\t\t\trowNode.fadeOut(800, function(){\n\t\t\t\t\t\t\trowNode.remove();\n\t\t\t\t\t\t\tupdateSlotSectionStatus(itemType);\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t});\n\t};\n\n\tvar attachSelectedSlotChangeEvents = function() {\n\t\tformAndDialogBox.on('change', '.js-wpml-ls-available-slots', function(){\n\t\t\tvar newSlug = $(this).val(),\n\t\t\t\tsubform = $(this).closest('.js-wpml-ls-subform'),\n\t\t\t\titemType = subform.data('item-type');\n\n\t\t\t$(this).removeClass('wpml-ls-required');\n\n\t\t\tif (isSlotAllowed(newSlug, itemType)) {\n\t\t\t\treplaceSubformElementsAttributes(subform, newSlug);\n\t\t\t}\n\t\t});\n\t};\n\n\tvar resetColorpickers = function(node) {\n\t\tnode.find('.js-wpml-ls-colorpicker').each( function() {\n\t\t\tvar nodeClone  = $(this).clone(),\n\t\t\t\tparentNode = $(this).parents('.js-wpml-ls-colorpicker-wrapper');\n\n\t\t\tparentNode.empty().html(nodeClone);\n\t\t});\n\n\t\tinitColorPicker(node);\n\t};\n\n\tvar preselectSlot = function(subform) {\n\t\tif (currentItemSlug) {\n\t\t\tvar selector = '.js-wpml-ls-available-slots option[value=\"' + currentItemSlug + '\"]';\n\t\t\tsubform.find(selector).attr('selected', 'selected');\n\t\t\tcurrentItemSlug = null;\n\t\t}\n\t};\n\n\tvar attachPresetColorsEvent = function() {\n\t\tformAndDialogBox.on('change', '.js-wpml-ls-colorpicker-preset', function(){\n\t\t\tvar slug = $(this).val(),\n\t\t\t\tsubform = $(this).parents('.js-wpml-ls-subform');\n\n\t\t\tif (slug) {\n\t\t\t\tvar pickerSets = $(this).parents('.js-wpml-ls-panel-colors'),\n\t\t\t\t\tcolors     = wpml_ls.color_schemes[ slug ].values;\n\n\t\t\t\t$.each(colors, function(k, v){\n\t\t\t\t\tvar inputTags = pickerSets.find('.js-wpml-ls-color-' + k);\n\t\t\t\t\tinputTags.attr('value', v);\n\t\t\t\t\tinputTags.parents('.wp-picker-container').find('.wp-color-result').css('background-color', v);\n\t\t\t\t});\n\n\t\t\t\tupdatePreview(subform);\n\t\t\t}\n\t\t});\n\t};\n\n\tvar fixSelectedOption = function() {\n\t\t// Prevent loosing selected after replacing in original id\n\t\tformAndDialogBox.on('change', 'select', function () {\n\t\t\tvar selectedVal = $(this).val();\n\t\t\t$('option', this).removeAttr('selected');\n\t\t\t$('option[value=\"' + selectedVal + '\"]', this).attr('selected', 'selected');\n\t\t});\n\t};\n\n\t/**\n\t * @see http://stackoverflow.com/a/19196020\n\t */\n\tvar forceRefreshOnBrowserBackButton = function() {\n\t\tvar input = $('#wpml-ls-refresh-on-browser-back-button');\n\n\t\tif(input.val() === 'yes') {\n\t\t\tlocation.reload(true);\n\t\t} else {\n\t\t\tinput.val('yes');\n\t\t}\n\t};\n\n\tvar setupWizardNextEvent = function() {\n\t\tform.submit(function(e){\n\t\t\te.preventDefault();\n\n\t\t\tform.find('input[name=\"submit_setup_wizard\"]').val(1);\n\n\t\t\tupdateSettings(form, function(){\n\t\t\t\tlocation.href = location.href.replace(/#.*/,'');\n\t\t\t});\n\t\t});\n\t};\n\n\tvar preventClickOnPreviewLinks = function () {\n\t\t$('.js-wpml-ls-preview').on('click', function(e) {\n\t\t\te.preventDefault();\n\t\t});\n\t};\n\n\tvar openTooltip = function(triggerNode) {\n\t\tvar content = triggerNode.data('content');\n\t\tvar link_text = triggerNode.data('link-text');\n\t\tvar link_url = triggerNode.data('link-url');\n\t\tvar link_target = triggerNode.data('link-target');\n\n\t\tif (link_text.length > 0) {\n\t\t\tif (link_url.length === 0) {\n\t\t\t\tlink_url = '#';\n\t\t\t}\n\t\t\tvar content_link_target = 'target=\"' + link_target + '\"';\n\t\t\tcontent += '<br><br><a href=\"' + link_url + '\" ' + content_link_target + '>';\n\t\t\tcontent += link_text;\n\t\t\tcontent += '</a>';\n\t\t}\n\n\t\t$('.js-wpml-ls-active-tooltip').pointer('close');\n\n\t\tif(triggerNode.length && content) {\n\t\t\ttriggerNode.addClass('js-wpml-ls-active-tooltip');\n\t\t\ttriggerNode.pointer({\n\t\t\t\tpointerClass : 'js-wpml-ls-tooltip wpml-ls-tooltip',\n\t\t\t\tcontent:       content,\n\t\t\t\tposition: {\n\t\t\t\t\tedge:  'bottom',\n\t\t\t\t\talign: 'left'\n\t\t\t\t},\n\t\t\t\tshow: function(event, t){\n\t\t\t\t\tt.pointer.css('marginLeft', '-54px');\n\t\t\t\t},\n\t\t\t\tclose: function(event, t){\n\t\t\t\t\tt.pointer.css('marginLeft', '0');\n\t\t\t\t},\n\t\t\t\tbuttons: function( event, t ) {\n\t\t\t\t\tvar button = $('<a class=\"close\" href=\"#\">&nbsp;</a>');\n\n\t\t\t\t\treturn button.bind( 'click.pointer', function(e) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tt.element.pointer('close');\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t}).pointer('open');\n\t\t}\n\t};\n\n\tvar cloneSubformIntoDialog = function(subform) {\n\t\tvar subformClone = subform.clone(true);\n\n\t\tdialogBox.find('.js-wpml-ls-dialog-inner').empty().append(subformClone);\n\n\t\tif('' === subformClone.find('.js-wpml-ls-preview').html()) {\n\t\t\tupdatePreview(subformClone);\n\t\t}\n\n\t\tprepareSlotInlineStyles(subform);\n\t\tupdateAvailableSlotsSelector(subformClone);\n\t\tresetColorpickers(subformClone);\n\t\tpreselectSlot(subformClone);\n\n\t\tdialogBox.dialog('option', 'title', subformClone.data('title'))\n\t\t\t.dialog('open');\n\t};\n\n\tvar prepareSlotInlineStyles = function(subform) {\n\t\tvar type = subform.data('item-type');\n\t\tvar slug = subform.data('item-slug');\n\n\t\tslug = '%id%' === slug ? '__id__' : slug;\n\t\tvar inlineStyles = $('#wpml-ls-inline-styles-' + type + '-' + slug);\n\t\tslotInlineStylesBackup = inlineStyles.detach();\n\t\tupdateDialogInlineStyle(slotInlineStylesBackup.clone());\n\t};\n\n\tvar restoreInlineStyles = function() {\n\t\tif ( slotInlineStylesBackup instanceof jQuery && slotInlineStylesBackup.length > 0) {\n\t\t\t$('#' + additionalCssStyleId).before(slotInlineStylesBackup);\n\t\t}\n\t};\n\n\tvar replaceDialogSubformIntoOrigin = function(subform) {\n\t\tvar subformClone = subform.clone(true),\n\t\t\titemType     = subform.data('item-type');\n\n\t\tsubformClone.find('.js-wpml-ls-preview-wrapper').css('top', 0);\n\n\t\tif(0 <= $.inArray(itemType, [\"menus\", \"sidebars\"] )) {\n\t\t\tvar selectedSlot = subform.find('.js-wpml-ls-available-slots').val();\n\n\t\t\tif (isSlotAllowed(selectedSlot, itemType)) {\n\t\t\t\tif (typeof subformClone.data('origin-id') === 'undefined') {\n\t\t\t\t\tappendNewRowAndSubform(subformClone);\n\t\t\t\t} else {\n\t\t\t\t\tupdateRowAndSubform(subformClone);\n\t\t\t\t}\n\n\t\t\t\tupdateSlotSectionStatus(itemType);\n\t\t\t} else {\n\t\t\t\tmissingSlotWarning(subform);\n\t\t\t}\n\t\t} else if(subformClone.data('item-type') === 'statics'){\n\t\t\tupdateStaticSlot(subformClone);\n\t\t}\n\t};\n\n\tvar updateSlotSectionStatus = function(itemType) {\n\t\tvar section    = $('#wpml-language-switcher-' + itemType),\n\t\t\tnumItems   = section.find('.js-wpml-ls-row').length,\n\t\t\tnumAllowed = $.map(wpml_ls[ itemType ], function(n, i) { return i; }).length;\n\n\t\tif (numItems === 0) {\n\t\t\tsection.find('.js-wpml-ls-slot-list').fadeOut();\n\t\t} else {\n\t\t\tsection.find('.js-wpml-ls-slot-list').fadeIn();\n\t\t}\n\n\t\tif (numItems === numAllowed) {\n\t\t\tsection.find('button.js-wpml-ls-open-dialog').attr('disabled', 'disabled')\n\t\t\t\t.siblings('.js-wpml-ls-tooltip-wrapper').removeClass('hidden');\n\t\t} else {\n\t\t\tsection.find('button.js-wpml-ls-open-dialog').removeAttr('disabled')\n\t\t\t\t.siblings('.js-wpml-ls-tooltip-wrapper').addClass('hidden');\n\t\t}\n\t};\n\n\tvar updateStaticSlot = function(subform) {\n\t\tvar wrapper = $('#' + subform.data('origin-id')),\n\t\t\tslug    = subform.data('item-slug');\n\n\t\twrapper.find('.js-wpml-ls-subform').replaceWith(subform);\n\n\t\tcopyDialogInlineStyleToSlot('statics', slug);\n\n\t\tupdateSettings(wrapper, function() {\n\t\t\tdialogBox.find('.js-wpml-ls-dialog-inner').empty();\n\t\t\tdialogBox.dialog('close');\n\t\t});\n\t};\n\n\tvar updateRowAndSubform = function(subform) {\n\t\tvar row      = $('#' + subform.data('origin-id')),\n\t\t\titemType = subform.data('item-type'),\n\t\t\tslug     = subform.find('.js-wpml-ls-available-slots').val();\n\n\t\trow.find('.js-wpml-ls-subform').replaceWith(subform);\n\n\t\tif(row.attr('id') !== 'wpml-ls-' + itemType +'-row-' + slug){\n\t\t\tupdateRowOnItemSlotChange(row, itemType, slug);\n\t\t}\n\n\t\tcopyDialogInlineStyleToSlot(itemType, slug);\n\n\t\tupdateSettings(row, function() {\n\t\t\tdialogBox.find('.js-wpml-ls-dialog-inner').empty();\n\t\t\tdialogBox.dialog('close');\n\t\t});\n\t};\n\n\tvar appendNewRowAndSubform = function(subform) {\n\t\tvar itemType = subform.data('item-type'),\n\t\t\tslug     = subform.find('.js-wpml-ls-available-' + itemType).val();\n\n\t\treplaceSubformElementsAttributes(subform, slug);\n\n\t\tvar tplString = $.trim($('#wpml-ls-new-' + itemType + '-row-template').html()),\n\t\t\tnewRow    = $($.parseHTML(tplString));\n\n\t\tnewRow.find('.js-wpml-ls-subform').replaceWith(subform);\n\t\tupdateRowOnItemSlotChange(newRow, itemType, slug);\n\t\tnewRow.hide().appendTo(form.find('#wpml-ls-slot-list-' + itemType + ' > tbody')).show(800);\n\n\t\tcopyDialogInlineStyleToSlot(itemType, slug);\n\n\t\tupdateSettings(newRow, function() {\n\t\t\tdialogBox.find('.js-wpml-ls-dialog-inner').empty();\n\t\t\tdialogBox.dialog('close');\n\t\t});\n\t};\n\n\tvar missingSlotWarning = function(subform) {\n\t\tsubform.find('.js-wpml-ls-available-slots').addClass('wpml-ls-required');\n\t\tdialogBox.animate({scrollTop:0}, 300);\n\t\t$('.js-wpml-ls-dialog-save').prop('disabled', false);\n\t};\n\n\tvar updateRowOnItemSlotChange = function(row, itemType, slug) {\n\t\tvar newRowId = 'wpml-ls-' + itemType +'-row-' + slug,\n\t\t\tnewTitle = wpml_ls[ itemType ][ slug ].name;\n\n\t\trow.attr('id', newRowId);\n\t\trow.data('item-type', itemType);\n\t\trow.find('.js-wpml-ls-subform').addBack().data('item-slug', slug);\n\t\trow.find('.js-wpml-ls-subform').data('origin-id', newRowId);\n\t\trow.find('.js-wpml-ls-row-title').html(newTitle);\n\t};\n\n\tvar replaceSubformElementsAttributes = function(subform, newSlug) {\n\t\tvar attr     = '',\n\t\t\titemType = subform.data('item-type'),\n\t\t\toldSlug  = subform.data('item-slug');\n\n\t\tsubform.find('input, select').each(function(i, el){\n\t\t\tattr = $(el).attr('name');\n\t\t\tif( typeof attr === 'string') {\n\t\t\t\t$(el).attr('name', attr.replace(itemType + '[' + oldSlug +']', itemType + '[' + newSlug +']') );\n\t\t\t}\n\n\t\t\tattr = $(el).attr('id');\n\t\t\tif( typeof attr === 'string') {\n\t\t\t\t$(el).attr('id', attr.replace(oldSlug, newSlug) );\n\t\t\t}\n\t\t});\n\n\t\tsubform.find('label').each(function(i, el){\n\t\t\tattr = $(el).attr('for');\n\t\t\tif( typeof attr === 'string') {\n\t\t\t\t$(el).attr('for', attr.replace(oldSlug, newSlug) );\n\t\t\t}\n\t\t});\n\t};\n\n\tvar prepareTemplateSubform = function(targetNode) {\n\t\tvar tplString = $.trim(targetNode.html()),\n\t\t\tsubform   = $($.parseHTML(tplString));\n\n\t\tupdateAvailableSlotsSelector(subform);\n\n\t\treturn subform;\n\t};\n\n\tvar getUsedSlots = function( type ) {\n\t\tvar slotSlugs = [];\n\t\t$('#wpml-ls-slot-list-' + type + ' .js-wpml-ls-row').each( function() {\n\t\t\tslotSlugs.push($(this).data('item-slug'));\n\t\t});\n\n\t\treturn slotSlugs;\n\t};\n\n\tvar isSlotAllowed = function(slot, itemType) {\n\t\tvar allowedSlots = $.map(wpml_ls[ itemType ], function(el) {\n\t\t\treturn itemType === 'menus' ? el.term_id.toString() : el.id;\n\t\t});\n\n\t\treturn 0 <= $.inArray(slot, allowedSlots);\n\t};\n\n\tvar updateAvailableSlotsSelector = function(subform) {\n\t\tvar itemType            = subform.data('item-type'),\n\t\t\talreadyUsed         = getUsedSlots(itemType),\n\t\t\tselectedOption      = subform.data('item-slug'),\n\t\t\tselectorOptionsNode = subform.find('.js-wpml-ls-available-slots option');\n\n\t\tselectorOptionsNode.each(function(){\n\t\t\tvar optionNode    = $(this),\n\t\t\t\tusedOption    = $.inArray(optionNode.val(), alreadyUsed) >= 0,\n\t\t\t\tcurrentOption = optionNode.val();\n\n\t\t\tif (usedOption && selectedOption !== currentOption) {\n\t\t\t\toptionNode.attr('disabled', 'disabled');\n\t\t\t} else {\n\t\t\t\toptionNode.removeAttr('disabled');\n\t\t\t}\n\t\t});\n\t};\n\n\tvar attachUpdatePreviewEvents = function() {\n\t\tformAndDialogBox\n\t\t\t.on('change', '[type!=\"text\"].js-wpml-ls-trigger-update', function(){\n\t\t\t\tvar subform = $(this).parents('.js-wpml-ls-subform');\n\t\t\t\tupdatePreview(subform);\n\t\t\t})\n\t\t\t.on('keyup', '[type=\"text\"].js-wpml-ls-trigger-update', function(){\n\t\t\t\tvar subform = $(this).parents('.js-wpml-ls-subform');\n\t\t\t\tupdatePreview(subform);\n\t\t\t})\n\t\t\t.on('keyup', '.js-wpml-ls-additional-css', function(){\n\t\t\t\tvar styleId      = 'wpml-ls-inline-styles-additional-css',\n\t\t\t\t\tnewStyleNode = $('<style id=\"' + styleId + '\" type=\"text/css\">' + $(this).val() + '</style>');\n\n\t\t\t\t$('#' + styleId).replaceWith(newStyleNode);\n\t\t\t});\n\t};\n\n\tvar attachTemplateChangeEvents = function() {\n\t\tformAndDialogBox.on('change', '.js-wpml-ls-template-selector', function() {\n\t\t\tvar selected = $(this).val(),\n\t\t\t\tsubform  = $(this).closest('.js-wpml-ls-subform'),\n\t\t\t\tforce    = wpml_ls.templates[ selected ].force_settings;\n\n\t\t\tsubform.find('.js-wpml-ls-to-include input').prop('disabled', false);\n\n\t\t\tjQuery.each(force, function(k, v){\n\t\t\t\tif(v === 1) {\n\t\t\t\t\tsubform.find('.js-wpml-ls-setting-' + k).attr('checked', 'checked').prop('disabled', true);\n\t\t\t\t} else {\n\t\t\t\t\tsubform.find('.js-wpml-ls-setting-' + k).removeAttr('checked').prop('disabled', true);\n\t\t\t\t}\n\t\t\t});\n\t\t});\n\t};\n\n\tvar attachMenuHierarchicalEvents = function() {\n\t\tformAndDialogBox.on('change', '.js-wpml-ls-menu-is-hierarchical', function() {\n\t\t\tvar isHierarchical          = parseInt($(this).val()),\n\t\t\t\tsubform                 = $(this).closest('.js-wpml-ls-subform'),\n\t\t\t\tincludeCurrentLangInput = subform.find('.js-wpml-ls-setting-display_link_for_current_lang');\n\n\t\t\tincludeCurrentLangInput.prop('disabled', false);\n\n\t\t\tif(isHierarchical === 1) {\n\t\t\t\tincludeCurrentLangInput.attr('checked', 'checked').prop('disabled', true);\n\t\t\t}\n\t\t});\n\t};\n\n\tvar updatePreview = _.debounce( function(subform) {\n\t\t$('.js-wpml-ls-dialog-save').prop('disabled', true);\n\t\tvar preview = subform.find('.js-wpml-ls-preview');\n\n\t\tif(preview.length > 0) {\n\t\t\tshowSpinner(preview);\n\t\t\tvar previewData = getSerializedSettings(subform);\n\n\t\t\twp.ajax.send({\n\t\t\t\tdata: {\n\t\t\t\t\taction:        'wpml-ls-update-preview',\n\t\t\t\t\tnonce:         wpml_ls.nonce,\n\t\t\t\t\tslot_settings: previewData\n\t\t\t\t},\n\t\t\t\tsuccess:  function (data) {\n\t\t\t\t\tpreview.empty();\n\t\t\t\t\tupdateDialogInlineStyle(data.styles);\n\t\t\t\t\tbuildCSSLinks(data.css);\n\t\t\t\t\tbuildJSScripts(data.js);\n\t\t\t\t\tshowUpdatedContent(preview, data.html);\n\t\t\t\t},\n\t\t\t\terror: function (data) {\n\t\t\t\t\tshowUpdatedContent(preview, data, 0, 'error');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}, 500);\n\n\tvar attachSaveClickEvents = function() {\n\t\tform.on('click', '.js-wpml-ls-save-settings', function(e){\n\t\t\te.preventDefault();\n\t\t\tupdateSettings($(this));\n\t\t});\n\t};\n\n\tvar updateSettings = _.debounce(function (wrapper, successCallback) {\n\t\tvar messageWrapper = wrapper.closest('.js-wpml-ls-option').find('.js-wpml-ls-messages'),\n\t\t\tsettings       = getSerializedSettings(form);\n\n\t\tif(messageWrapper.length === 0) {\n\t\t\tmessageWrapper = wrapper.closest('.js-wpml-ls-section').find('.js-wpml-ls-messages');\n\t\t}\n\n\t\tmessageWrapper.empty();\n\t\tshowSpinner(messageWrapper);\n\n\t\twp.ajax.send({\n\t\t\tdata: {\n\t\t\t\taction:   'wpml-ls-save-settings',\n\t\t\t\tnonce:    wpml_ls.nonce,\n\t\t\t\tsettings: settings\n\t\t\t},\n\t\t\tsuccess:  function (data) {\n\t\t\t\tshowUpdatedContent(messageWrapper, data, 2500, 'updated');\n\n\t\t\t\tif(typeof successCallback === 'function') {\n\t\t\t\t\tsuccessCallback();\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function (data) {\n\t\t\t\tshowUpdatedContent(messageWrapper, data, 2500, 'error');\n\t\t\t}\n\t\t});\n\t}, 500);\n\n\tvar getSerializedSettings = function(form) {\n\t\tvar disabled = form.find(':input:disabled').removeAttr('disabled'),\n\t\t\tsettings = form.find('input, select, textarea').serialize();\n\n\t\tdisabled.attr('disabled','disabled');\n\n\t\treturn settings;\n\t};\n\n\tvar showSpinner = function(wrapper) {\n\t\t$('.js-wpml-ls-messages').removeClass('success error').hide().empty();\n\t\twrapper.siblings('.spinner').addClass('is-active');\n\t};\n\n\tvar showUpdatedContent = function(wrapper, content, delay, type) {\n\t\twrapper.siblings('.spinner').removeClass('is-active');\n\n\t\twrapper.removeClass('updated notice error');\n\n\t\tif(type) {\n\t\t\twrapper.addClass(type);\n\t\t}\n\n\t\twrapper.html(content).fadeIn();\n\n\t\tif(delay) {\n\t\t\twrapper.delay(delay).fadeOut();\n\t\t}\n\n\t\t$('.js-wpml-ls-dialog-save').prop('disabled', false);\n\t};\n\n\tvar updateDialogInlineStyle = function (styles) {\n\t\t $('#' + dialogInlineStyleId).remove();\n\n\t\tif(styles) {\n\t\t\tvar newDialogStyle;\n\n\t\t\tif (styles instanceof jQuery) {\n\t\t\t\tnewDialogStyle = styles;\n\t\t\t} else {\n\t\t\t\tnewDialogStyle = $($.parseHTML(styles)).first();\n\t\t\t}\n\n\t\t\tnewDialogStyle.attr('id', dialogInlineStyleId);\n\t\t\t$('#' + additionalCssStyleId).before(newDialogStyle);\n\t\t}\n\t};\n\n\tvar copyDialogInlineStyleToSlot = function (itemType, slug) {\n\t\tvar dialogStyleClone = $('#' + dialogInlineStyleId).clone(),\n\t\t\ttargetId         = 'wpml-ls-inline-styles-' + itemType + '-' + slug,\n\t\t\ttargetStyle      = $('#' + targetId);\n\n\t\tdialogStyleClone.attr('id', targetId);\n\n\t\tif (targetStyle.length) {\n\t\t\ttargetStyle.replaceWith(dialogStyleClone);\n\t\t} else {\n\t\t\t$('#' + additionalCssStyleId).before(dialogStyleClone);\n\t\t}\n\t};\n\n\tvar buildCSSLinks = function (css) {\n\t\tvar i,\n\t\t\tlinkTag;\n\n\t\tif (typeof css !== typeof undefined && null !== css) {\n\t\t\tfor (i = 0; i < css.length; i++) {\n\t\t\t\tlinkTag = $('link[href=\"' + css[i] + '\"]');\n\n\t\t\t\tif (0 === linkTag.length) {\n\t\t\t\t\tlinkTag = $('<link>');\n\t\t\t\t\tlinkTag.attr('rel', 'stylesheet');\n\t\t\t\t\tlinkTag.attr('type', 'text/css');\n\t\t\t\t\tlinkTag.attr('media', 'all');\n\t\t\t\t\tlinkTag.attr('href', css[i]);\n\t\t\t\t\tlinkTag.prependTo('head');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\tvar buildJSScripts = function (js) {\n\t\tvar i,\n\t\t\tjsTag;\n\n\t\tif (typeof js !== typeof undefined && null !== js) {\n\t\t\tfor (i = 0; i < js.length; i++) {\n\t\t\t\tjsTag = $('script[src=\"' + js[i] + '\"]');\n\n\t\t\t\tif (0 === jsTag.length) {\n\t\t\t\t\tjsTag = $('<script></script>');\n\t\t\t\t\tjsTag.attr('type', 'text/javascript');\n\t\t\t\t\tjsTag.attr('src', js[i]);\n\t\t\t\t\tjsTag.prependTo('head');\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t};\n\n\treturn {\n\t\t'init': init\n\t};\n\n})( jQuery, wpml_language_switcher_admin );\n\njQuery(document).ready(function () {\n\t\"use strict\";\n\n\tWPML_core.languageSwitcher.init();\n});"]}